    <!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NetAdmin Cloud v8.0</title>
    <style>
        :root {
            --bg-body: #f0f2f5; --bg-surface: #ffffff; --bg-input: #e4e6eb;
            --text-main: #1c1e21; --text-sec: #65676b;
            --primary: #1877f2; --danger: #ff4d4f; --warning: #f7b928; --success: #42b72a;
            --border: #ced0d4; --radius: 12px; --shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        body.dark-mode {
            --bg-body: #18191a; --bg-surface: #242526; --bg-input: #3a3b3c;
            --text-main: #e4e6eb; --text-sec: #b0b3b8; --border: #3e4042;
        }
        * { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: var(--bg-body); color: var(--text-main); margin: 0; padding: 0; transition: 0.3s; height: 100vh; overflow-y: auto; }

        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        input[type=number] { -moz-appearance: textfield; }

        /* PANTALLAS */
        .screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg-body); z-index: 2000; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 20px; text-align: center; }
        .hidden { display: none !important; }

        .welcome-box { background: var(--bg-surface); padding: 30px; border-radius: 20px; box-shadow: var(--shadow); max-width: 400px; width: 100%; border: 1px solid var(--border); }
        .logo { font-size: 3rem; margin-bottom: 10px; }
        h2 { margin: 10px 0; color: var(--primary); }
        
        .big-input { width: 100%; padding: 15px; border-radius: var(--radius); border: 2px solid var(--border); background: var(--bg-input); font-size: 1.1rem; text-align: center; color: var(--text-main); margin-bottom: 15px; }
        .btn-large { width: 100%; padding: 15px; background: var(--primary); color: white; border: none; border-radius: var(--radius); font-size: 1rem; font-weight: bold; cursor: pointer; }

        /* APP HEADER & GRID */
        #app-container { max-width: 900px; margin: 0 auto; padding: 20px; display: none; padding-bottom: 60px; }
        #app-container.visible { display: block; animation: fadeIn 0.5s; }

        .app-header-grid { display: grid; grid-template-columns: 1fr auto; gap: 15px; margin-bottom: 20px; align-items: center; }
        .quote-box { background: linear-gradient(135deg, var(--primary), #0056b3); color: white; padding: 15px; border-radius: var(--radius); font-size: 0.9rem; font-style: italic; box-shadow: var(--shadow); position: relative; overflow: hidden; text-shadow: 0 1px 2px rgba(0,0,0,0.2); }
        .controls { display: flex; gap: 8px; flex-wrap: wrap; justify-content: flex-end; }
        .btn-icon { background: var(--bg-surface); border: 1px solid var(--border); border-radius: 8px; width: 40px; height: 40px; cursor: pointer; font-size: 1.2rem; }

        /* TABS */
        .tabs-container { overflow-x: auto; padding-bottom: 5px; margin-bottom: 20px; }
        .tabs { display: flex; background: var(--bg-surface); padding: 5px; border-radius: 15px; box-shadow: var(--shadow); min-width: 350px; }
        .tab { flex: 1; text-align: center; padding: 12px 5px; border-radius: 10px; cursor: pointer; color: var(--text-sec); font-weight: 600; font-size: 0.9rem; white-space: nowrap; }
        .tab.active { background: var(--primary); color: white; }

        /* PILLS & LISTS */
        .sub-filters { display: flex; gap: 10px; margin-bottom: 15px; overflow-x: auto; padding-bottom: 5px; }
        .pill { padding: 6px 12px; border-radius: 20px; background: var(--bg-input); cursor: pointer; font-size: 0.85rem; color: var(--text-sec); border: 1px solid transparent; white-space: nowrap; }
        .pill.active { background: var(--bg-surface); border-color: var(--primary); color: var(--primary); font-weight: bold; }

        .list-box { background: var(--bg-surface); border-radius: var(--radius); padding: 15px; margin-bottom: 15px; border: 1px solid var(--border); }
        .list-head { display: flex; justify-content: space-between; font-weight: bold; margin-bottom: 10px; border-bottom: 1px solid var(--border); padding-bottom: 8px; }
        
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 10px; }
        
        /* CARD STYLES */
        .card { background: var(--bg-body); border: 1px solid var(--border); border-radius: 8px; padding: 12px; position: relative; cursor: pointer; border-left: 4px solid var(--border); overflow: hidden; }
        .card:active { transform: scale(0.98); }
        .card-label { font-weight: bold; font-size: 0.9rem; margin-bottom: 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        
        .card-val { 
            font-size: 0.8rem; color: var(--text-sec); font-family: monospace; 
            white-space: normal; overflow-wrap: anywhere; word-break: break-all;
            display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; line-height: 1.2;
        }

        .actions { position: absolute; top: 5px; right: 5px; display: none; background: rgba(255,255,255,0.9); border-radius: 4px; z-index: 10; padding:2px; }
        .card:hover .actions { display: block; } /* Solo visible si Admin est√° activo */
        
        /* Tipos de Tarjetas */
        .pass-card { border-top: 4px solid var(--danger); border-left: 0; }
        .note-card { border-left: 4px solid var(--warning); background: #fffceb; color: #5c4e06; cursor: default; white-space: pre-wrap; }
        body.dark-mode .note-card { background: #423805; color: #e6dbb5; }
        .reminder-card { border-left: 4px solid var(--success); display: flex; justify-content: space-between; align-items: center; cursor: default; }
        .cred-row { display: flex; align-items: center; justify-content: space-between; background: rgba(0,0,0,0.03); padding: 5px; border-radius: 4px; margin-top: 5px; font-size: 0.85rem; }
        .cred-val-fix { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; max-width: 80px; }

        /* CLOCK & MODALS */
        .time-selector { display: flex; gap: 5px; background: var(--bg-input); padding: 10px; border-radius: 8px; margin-bottom: 15px; border: 1px solid var(--primary); }
        .ts-select { flex: 1; padding: 10px; border-radius: 6px; border: 1px solid #ccc; font-size: 1rem; text-align: center; background: var(--bg-surface); color: var(--text-main); }
        .modal-overlay { position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.6); z-index: 3000; display: none; justify-content: center; align-items: center; }
        .alert-box { background: var(--bg-surface); padding: 25px; border-radius: 20px; text-align: center; max-width: 300px; border: 2px solid var(--primary); }
        .admin-badge { background: var(--danger); color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.7rem; font-weight: bold; margin-left: 5px; display: none; }
        
        #toast { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); background: #333; color: white; padding: 10px 20px; border-radius: 20px; opacity: 0; pointer-events: none; transition: 0.3s; z-index: 5000; }
        #toast.show { opacity: 1; transform: translateY(-10px); }

        @keyframes fadeIn { from{opacity:0} to{opacity:1} }
    </style>
</head>
<body>

    <div id="login-screen" class="screen">
        <div class="welcome-box">
            <div class="logo">üè¢</div>
            <h2>Acceso Corporativo</h2>
            
            <label style="display:block; font-size:0.85rem; color:var(--text-sec); margin-bottom:5px">Hora de Salida Hoy:</label>
            <div class="time-selector">
                <select id="ts-hour" class="ts-select"></select>
                <select id="ts-min" class="ts-select"><option value="00">00</option><option value="30">30</option></select>
                <select id="ts-ampm" class="ts-select"><option value="PM">PM</option><option value="AM">AM</option></select>
            </div>

            <input type="text" id="login-user" class="big-input" placeholder="Usuario">
            <input type="password" id="login-pass" class="big-input" placeholder="Contrase√±a">
            
            <button class="btn-large" onclick="attemptLogin()">Iniciar Sesi√≥n</button>
            
            <p style="margin-top:20px; font-size:0.8rem; cursor:pointer; color:var(--text-sec)" onclick="toggleAdminPanel()">¬øEres Administrador?</p>
            <div id="admin-token-area" class="hidden" style="margin-top:10px; border-top:1px solid #ccc; padding-top:10px">
                <p style="font-size:0.8rem; color:var(--danger)">Ingresa Token de GitHub para Editar:</p>
                <input type="password" id="admin-token" class="big-input" style="font-size:0.9rem" placeholder="ghp_xxxxxxxxxxxx">
                <button class="mini-btn" style="width:100%; padding:8px" onclick="saveToken()">Guardar Token</button>
            </div>
        </div>
    </div>

    <div id="app-container">
        <div class="app-header-grid">
            <div class="quote-box" id="daily-quote">"La disciplina es el puente entre metas y logros."</div>
            <div style="text-align: right;">
                <div style="font-weight:bold"><span id="username-display">Soporte</span> <span id="admin-badge" class="admin-badge">ADMIN</span></div>
                <div style="font-size:0.8rem; color:var(--text-sec)">Salida: <span id="display-time">--:--</span></div>
            </div>
        </div>

        <div class="controls" style="margin-bottom: 15px;">
            <span id="sync-status" style="margin-right:auto; font-size:0.8rem; display:flex; align-items:center; color:var(--text-sec)">‚òÅÔ∏è Conectando...</span>
            <button class="btn-icon" onclick="toggleTheme()" title="Tema">üåì</button>
            <button class="btn-icon" onclick="logout()" title="Salir">üîí</button>
        </div>

        <div class="tabs-container">
            <div class="tabs">
                <div class="tab active" onclick="switchTab('clip')">üìã Links</div>
                <div class="tab" onclick="switchTab('pass')">üîê Pass</div>
                <div class="tab" onclick="switchTab('notes')">üìù Notas</div>
                <div class="tab" onclick="switchTab('reminders')">‚è∞ Alarmas</div>
            </div>
        </div>

        <div id="view-clip"></div>
        <div id="view-pass" class="hidden"></div>
        
        <div id="view-notes" class="hidden">
            <div class="sub-filters">
                <div class="pill active" onclick="filterNotes('General')">General</div>
                <div class="pill" onclick="filterNotes('D√≠a')">üåû D√≠a</div>
                <div class="pill" onclick="filterNotes('Tarde')">‚õÖ Tarde</div>
                <div class="pill" onclick="filterNotes('Noche')">üåô Noche</div>
            </div>
            <div id="notes-grid" class="grid" style="display:flex; flex-direction:column; gap:10px;"></div>
            <button class="btn-large" style="margin-top:15px; background:transparent; border:2px dashed #ccc; color:#777" onclick="addNote()">+ Nueva Nota</button>
        </div>

        <div id="view-reminders" class="hidden">
            <div id="reminders-list" style="display:flex; flex-direction:column; gap:10px;"></div>
            <button class="btn-large" style="margin-top:15px; background:transparent; border:2px dashed #ccc; color:#777" onclick="addReminder()">+ Nuevo Recordatorio</button>
        </div>

        <footer style="text-align:center; color:var(--text-sec); margin-top:32px; font-size:0.92em; opacity:0.8;">
            NetAdmin Cloud<br>Versi√≥n V8.0 - Build 2026<br>¬© 2026 - Espiral - Leonardo Montiel
        </footer>
    </div>

    <div id="backup-modal" class="modal-overlay">
        <div class="alert-box alert-danger" style="border-color:var(--danger)">
            <div style="font-size:3rem">üö®</div>
            <h3 style="color:var(--danger)">ALERTA DE SALIDA</h3>
            <p>Falta 1 hora para tu salida.<br>Verifica tus pendientes.</p>
            <button class="btn-large" onclick="stopAlarm()">ENTENDIDO</button>
        </div>
    </div>

    <div id="nag-modal" class="modal-overlay">
        <div class="alert-box" style="border-color:var(--warning)">
            <div style="font-size:3rem">üîî</div>
            <h3>RECORDATORIO</h3>
            <p id="nag-text" style="font-weight:bold; font-size:1.1rem">...</p>
            <button class="btn-large" onclick="dismissNag()">‚úÖ LISTO</button>
        </div>
    </div>

    <div id="toast">Copiado</div>
    <audio id="alarm-sound" loop src="data:audio/mp3;base64,//NExAAAAANIAAAAAExBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//NExAAAAANIAAAAAExBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq"></audio>

    <script>
        // --- CONFIGURACI√ìN DE LA NUBE (EDITA ESTO) ---
        const GH_CONFIG = {
            USER: 'TU_USUARIO_GITHUB',  // <--- PON TU USUARIO AQU√ç
            REPO: 'NOMBRE_DE_TU_REPO',  // <--- PON TU REPO AQU√ç (ej: app-soporte)
            FILE: 'db.json'
        };

        const QUOTES = ["La excelencia no es un acto, es un h√°bito.","Si puedes so√±arlo, puedes hacerlo.","La tecnolog√≠a es mejor cuando une a las personas.","Hazlo con pasi√≥n o no lo hagas.","Un error es una oportunidad para aprender."];
        
        // DATOS EN MEMORIA
        let cloudData = { clipboard: [], passwords: [] }; // Viene de GitHub
        let localData = { notes: [], reminders: [], theme: 'light' }; // Se guarda en el navegador
        let isAdmin = false;
        let ghToken = localStorage.getItem('gh_admin_token') || '';
        let fileSha = null; // Necesario para actualizar en GitHub

        let dailyExitTime = null;
        let alarmTriggered = false;
        let currentNagId = null;
        const alarmAudio = document.getElementById('alarm-sound');
        let currentNoteFilter = 'General';

        window.onload = function() {
            // Inicializar UI
            const selHour = document.getElementById('ts-hour');
            for(let i=1; i<=12; i++) { let opt = document.createElement('option'); opt.value = i; opt.text = i; selHour.appendChild(opt); }
            document.getElementById('daily-quote').innerText = QUOTES[Math.floor(Math.random() * QUOTES.length)];
            
            // Cargar datos locales
            const savedLocal = localStorage.getItem('netAdminLocal_v8');
            if(savedLocal) {
                localData = JSON.parse(savedLocal);
                if(localData.theme === 'dark') document.body.classList.add('dark-mode');
            }
            
            setInterval(checkTime, 30000); 
            setInterval(checkReminders, 20000);
        };

        // --- 1. LOGIN ---
        function attemptLogin() {
            const user = document.getElementById('login-user').value.trim();
            const pass = document.getElementById('login-pass').value.trim();
            
            // L√≥gica de Acceso Fija
            if(user === 'Soporte' && pass === '45637954') {
                isAdmin = false;
                completeLogin('Soporte');
            } else if (user === 'Admin' && pass === '45637954') {
                isAdmin = true;
                if(!ghToken) alert("‚ö†Ô∏è Eres Admin pero no has guardado el Token de GitHub. No podr√°s editar.");
                completeLogin('Administrador');
            } else {
                alert("Usuario o Contrase√±a incorrectos");
            }
        }

        function completeLogin(name) {
            // Configurar hora salida
            let h = parseInt(document.getElementById('ts-hour').value);
            const m = document.getElementById('ts-min').value;
            const ampm = document.getElementById('ts-ampm').value;
            if(ampm === 'PM' && h !== 12) h += 12; if(ampm === 'AM' && h === 12) h = 0;
            dailyExitTime = `${String(h).padStart(2,'0')}:${m}`;

            // UI
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('app-container').classList.add('visible');
            document.getElementById('username-display').innerText = name;
            document.getElementById('display-time').innerText = `${document.getElementById('ts-hour').value}:${m} ${ampm}`;
            
            if(isAdmin) {
                document.getElementById('admin-badge').style.display = 'inline-block';
            }

            // Descargar datos de la nube
            fetchFromGitHub();
            renderLocal(); // Notas y recordatorios
        }

        function toggleAdminPanel() {
            document.getElementById('admin-token-area').classList.toggle('hidden');
        }
        function saveToken() {
            const t = document.getElementById('admin-token').value.trim();
            if(t) { localStorage.setItem('gh_admin_token', t); ghToken = t; alert("Token Guardado"); }
        }
        function logout() { location.reload(); }

        // --- 2. GITHUB SYNC (API) ---
        async function fetchFromGitHub() {
            const status = document.getElementById('sync-status');
            status.innerText = "‚òÅÔ∏è Sincronizando...";
            
            const url = `https://api.github.com/repos/${GH_CONFIG.USER}/${GH_CONFIG.REPO}/contents/${GH_CONFIG.FILE}`;
            
            try {
                // Si hay token lo usamos (incluso Soporte puede necesitarlo si el repo es privado)
                // Para repo p√∫blico, Soporte no necesita headers.
                const headers = {};
                // Si el repo es privado y eres soporte, esto fallar√° a menos que usemos un proxy o un token read-only hardcodeado.
                // Asumimos Repo P√∫blico para Soporte, Repo Cualquiera para Admin con Token.
                if(isAdmin && ghToken) headers['Authorization'] = `token ${ghToken}`;
                
                const response = await fetch(url, { headers });
                if(!response.ok) throw new Error("Error conexi√≥n GitHub");
                
                const data = await response.json();
                fileSha = data.sha; // Importante para updates
                
                // Decodificar Base64 (con soporte UTF8)
                const content = decodeURIComponent(escape(atob(data.content)));
                cloudData = JSON.parse(content);
                
                status.innerText = "‚òÅÔ∏è Actualizado";
                status.style.color = "var(--success)";
                renderCloud();
            } catch (err) {
                console.error(err);
                status.innerText = "‚ö†Ô∏è Error Nube (Lectura)";
                status.style.color = "var(--danger)";
                // Cargar backup local si existe de sesiones previas? No, por seguridad requerimos red.
            }
        }

        async function pushToGitHub() {
            if(!isAdmin || !ghToken) return alert("No tienes permisos de escritura (Token faltante)");
            
            const status = document.getElementById('sync-status');
            status.innerText = "‚òÅÔ∏è Guardando...";
            
            const url = `https://api.github.com/repos/${GH_CONFIG.USER}/${GH_CONFIG.REPO}/contents/${GH_CONFIG.FILE}`;
            
            try {
                // Encode UTF8 to Base64
                const contentStr = JSON.stringify(cloudData, null, 2);
                const contentBase64 = btoa(unescape(encodeURIComponent(contentStr)));
                
                const body = {
                    message: "Update via NetAdmin App",
                    content: contentBase64,
                    sha: fileSha
                };

                const response = await fetch(url, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `token ${ghToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(body)
                });

                if(response.ok) {
                    const resData = await response.json();
                    fileSha = resData.content.sha; // Actualizar SHA
                    status.innerText = "‚òÅÔ∏è Guardado OK";
                    setTimeout(()=>status.innerText="‚òÅÔ∏è En l√≠nea", 2000);
                } else {
                    throw new Error("Error al guardar");
                }
            } catch (err) {
                status.innerText = "‚ö†Ô∏è Error al Guardar";
                alert("Error al subir cambios a GitHub. Revisa tu Token.");
            }
        }

        // --- 3. RENDER CLOUD DATA (LINKS & PASS) ---
        function renderCloud() {
            // Clipboard
            const clipDiv = document.getElementById('view-clip'); clipDiv.innerHTML = '';
            cloudData.clipboard.forEach((list, lIdx) => {
                const box = createListBox(list.title, 'clipboard', lIdx);
                const grid = box.querySelector('.grid');
                list.cards.forEach((c, cIdx) => {
                    grid.appendChild(createCard(c, 'clipboard', lIdx, cIdx));
                });
                if(isAdmin) appendAddBtn(grid, 'clipboard', lIdx);
                clipDiv.appendChild(box);
            });
            if(isAdmin) appendNewListBtn(clipDiv, 'clipboard');

            // Passwords
            const passDiv = document.getElementById('view-pass'); passDiv.innerHTML = '';
            cloudData.passwords.forEach((list, lIdx) => {
                const box = createListBox(list.title, 'passwords', lIdx);
                const grid = box.querySelector('.grid');
                list.cards.forEach((c, cIdx) => {
                    grid.appendChild(createCard(c, 'passwords', lIdx, cIdx));
                });
                if(isAdmin) appendAddBtn(grid, 'passwords', lIdx);
                passDiv.appendChild(box);
            });
            if(isAdmin) appendNewListBtn(passDiv, 'passwords');
        }

        // Helper Render Functions
        function createListBox(title, type, lIdx) {
            const div = document.createElement('div'); div.className = 'list-box';
            let delBtn = isAdmin ? `<button class="mini-btn" style="color:red" onclick="deleteList('${type}', ${lIdx})">x</button>` : '';
            div.innerHTML = `<div class="list-head"><span>${title}</span>${delBtn}</div><div class="grid"></div>`;
            return div;
        }

        function createCard(c, type, lIdx, cIdx) {
            const d = document.createElement('div');
            // Solo el admin ve el bot√≥n de borrar
            const actions = isAdmin ? `<div class="actions"><button class="mini-btn" onclick="deleteCard('${type}', ${lIdx}, ${cIdx})">üóëÔ∏è</button></div>` : '';
            
            if(type === 'clipboard') {
                d.className = 'card';
                d.onclick = (e) => { if(!e.target.closest('button')) copy(c.content); };
                d.innerHTML = `<div class="card-label">${c.label}</div><div class="card-val">${c.content}</div>${actions}`;
            } else {
                d.className = 'card pass-card';
                d.innerHTML = `<div class="card-label">${c.label}</div>
                               <div class="cred-row"><span>üë§ <span class="cred-val-fix">${c.user}</span></span><button class="mini-btn" onclick="copy('${c.user}')">C</button></div>
                               <div class="cred-row"><span class="blur">üîë <span class="cred-val-fix">${c.pass}</span></span><button class="mini-btn" onclick="copy('${c.pass}')">C</button></div>${actions}`;
            }
            return d;
        }

        function appendAddBtn(grid, type, lIdx) {
            const add = document.createElement('div'); add.className = 'card btn-add'; 
            add.style.border='2px dashed #ccc'; add.style.display='flex'; add.style.justifyContent='center'; add.innerText='+';
            add.onclick = () => addItem(type, lIdx);
            grid.appendChild(add);
        }

        function appendNewListBtn(container, type) {
            const btn = document.createElement('button'); btn.className='btn-large'; 
            btn.style.background='transparent'; btn.style.border='2px dashed #ccc'; btn.style.color='#777'; btn.innerText='+ Nueva Lista';
            btn.onclick = () => addList(type);
            container.appendChild(btn);
        }

        // --- 4. ADMIN ACTIONS (CLOUD MODIFICATION) ---
        function addItem(type, lIdx) {
            if(type === 'clipboard') {
                const l = prompt("T√≠tulo:"); const c = prompt("Contenido:");
                if(l && c) { cloudData.clipboard[lIdx].cards.push({id:Date.now(), label:l, content:c}); pushToGitHub(); renderCloud(); }
            } else {
                const l = prompt("Equipo:"); const u = prompt("Usuario:"); const p = prompt("Contrase√±a:");
                if(l && u && p) { cloudData.passwords[lIdx].cards.push({id:Date.now(), label:l, user:u, pass:p}); pushToGitHub(); renderCloud(); }
            }
        }
        function addList(type) {
            const t = prompt("Nombre de la Lista:");
            if(t) { cloudData[type].push({id:Date.now(), title:t, cards:[]}); pushToGitHub(); renderCloud(); }
        }
        function deleteCard(type, lIdx, cIdx) {
            if(confirm("¬øBorrar elemento de la Nube?")) { cloudData[type][lIdx].cards.splice(cIdx, 1); pushToGitHub(); renderCloud(); }
        }
        function deleteList(type, lIdx) {
            if(confirm("¬øBorrar Lista COMPLETA de la Nube?")) { cloudData[type].splice(lIdx, 1); pushToGitHub(); renderCloud(); }
        }

        // --- 5. LOCAL DATA (NOTES & REMINDERS) ---
        function renderLocal() {
            renderNotes(); renderReminders();
        }
        function saveLocal() {
            localStorage.setItem('netAdminLocal_v8', JSON.stringify(localData));
        }

        // Notes Logic
        function renderNotes() {
            const grid = document.getElementById('notes-grid'); grid.innerHTML = '';
            localData.notes.filter(n => n.filter === currentNoteFilter).forEach((n) => {
                const d = document.createElement('div'); d.className = 'card note-card';
                d.innerHTML = `<div>${n.text}</div><div class="actions"><button class="mini-btn" onclick="delNote(${n.id})">üóëÔ∏è</button></div>`;
                grid.appendChild(d);
            });
            document.querySelectorAll('.pill').forEach(p => p.classList.toggle('active', p.innerText.includes(currentNoteFilter)));
        }
        function filterNotes(f) { currentNoteFilter = f; renderNotes(); }
        function addNote() { const t = prompt("Nota:"); if(t) { localData.notes.push({id:Date.now(), text:t, filter:currentNoteFilter}); saveLocal(); renderNotes(); }}
        function delNote(id) { if(confirm("Borrar?")) { localData.notes = localData.notes.filter(n => n.id !== id); saveLocal(); renderNotes(); }}

        // Reminders Logic
        function renderReminders() {
            const list = document.getElementById('reminders-list'); list.innerHTML = '';
            localData.reminders.forEach((r) => {
                const d = document.createElement('div'); d.className = 'card reminder-card'; if(r.done) d.style.opacity = '0.6';
                d.innerHTML = `<div><div class="reminder-time">${r.displayTime}</div><div>${r.text}</div></div><div>${!r.done ? `<button class="mini-btn" onclick="completeReminder(${r.id})">‚úÖ</button>` : ''}<button class="mini-btn" style="color:red" onclick="delReminder(${r.id})">üóëÔ∏è</button></div>`;
                list.appendChild(d);
            });
        }
        function addReminder() {
            const txt = prompt("Recordar:"); if(!txt) return;
            const h = prompt("Hora (0-23):"); const m = prompt("Min (0-59):");
            if(h && m) { localData.reminders.push({id:Date.now(), text:txt, time:`${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}`, displayTime: `${h}:${m}`, done:false}); saveLocal(); renderReminders(); }
        }
        function completeReminder(id) { const r = localData.reminders.find(x=>x.id===id); if(r) r.done = true; saveLocal(); renderReminders(); if(currentNagId === id) dismissNag(); }
        function delReminder(id) { localData.reminders = localData.reminders.filter(x=>x.id!==id); saveLocal(); renderReminders(); }

        // --- UTILS ---
        function switchTab(t) {
            document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active')); event.target.classList.add('active');
            ['clip','pass','notes','reminders'].forEach(v => document.getElementById(`view-${v}`).classList.add('hidden'));
            document.getElementById(`view-${t}`).classList.remove('hidden');
            if(t==='notes') renderNotes(); if(t==='reminders') renderReminders();
        }
        function toggleTheme() { document.body.classList.toggle('dark-mode'); localData.theme = document.body.classList.contains('dark-mode')?'dark':'light'; saveLocal(); }
        async function copy(x) { try{await navigator.clipboard.writeText(x); showToast();}catch{const t=document.createElement('textarea');t.value=x;document.body.appendChild(t);t.select();document.execCommand('copy');document.body.removeChild(t);showToast();} }
        function showToast() { const t=document.getElementById('toast'); t.classList.add('show'); setTimeout(()=>t.classList.remove('show'),1500); }

        // ALARMS
        function checkTime() { 
            if(!dailyExitTime || alarmTriggered) return;
            const now = new Date(); const [h, m] = dailyExitTime.split(':'); const exit = new Date(); exit.setHours(h, m, 0);
            if((exit - now)/1000/60 <= 60 && (exit - now) > 0) { alarmTriggered = true; document.getElementById('backup-modal').style.display = 'flex'; try{alarmAudio.play()}catch(e){} }
        }
        function checkReminders() {
            const now = new Date(); const nowStr = `${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}`;
            localData.reminders.forEach(r => {
                if(!r.done && r.time === nowStr) {
                    if(currentNagId !== r.id) { currentNagId = r.id; document.getElementById('nag-text').innerText = r.text; document.getElementById('nag-modal').style.display = 'flex'; try { alarmAudio.play(); } catch(e){} if ("Notification" in window) new Notification("üîî Recordatorio", { body: r.text }); }
                    else { try { alarmAudio.play(); } catch(e){} }
                }
            });
        }
        function stopAlarm() { document.getElementById('backup-modal').style.display='none'; alarmAudio.pause(); }
        function dismissNag() { document.getElementById('nag-modal').style.display = 'none'; alarmAudio.pause(); alarmAudio.currentTime = 0; if(currentNagId) completeReminder(currentNagId); currentNagId = null; }

    </script>
</body>
</html>
